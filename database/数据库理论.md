# 数据库理论

## 1、数据库事务的并发问题
- 更新丢失：更新丢失分两类
	- 第一类：对于这样一个事务回滚另一个事务提交而引发的数据不一致的情况，我们称之为第一类丢失更新。（即事务回滚导致的另一个事务的更新丢失）
	- 第二类：多个事务都提交而引发的丢失更新称为第二类丢失更新。（即事务A覆盖事务B已经提交的数据，造成的丢失更新）
- 脏读：如果一个事务对数据进行了更新，但事务还没有提交，另一个事务就可以“看到”该事务没有提交的更新结果。这样就造成的问题就是，如果第一个事务回滚，那么第二个事务在此之前所“看到”的数据就是一笔脏数据。
- 不可重复读：不可重复读取是指同一个事务在整个事务过程中对同一笔数据进行读取，每次读取结果都不同。如果事务1在事务2的更新操作之前读取一次数据，在事务2的更新操作之后再读取同一笔数据一次，两次结果是不同的。
- 幻读：事务在操作中进行了两次读取，第二次查询结果包含了第一次查询中未出现的数据或缺少了第一次查询中出现的数据。

## 2、数据库隔离级别
- read uncommitted：读未提交，当一个事务开始写数据，则另外一个事务不允许同步进行写操作，但允许其他事务读此数据。即允许脏读，但不允许更新丢失。
- read committed：读已提交，一个事务只能读取到另一个事务的最终值，读不到中间状态。即允许不可重复读，但不允许脏读。
- repeatable read：可重复读，在同一次事务中的两次查询操作读取到的数据是一样的。即允许有幻读，但不允不可重复读和脏读。repeatable read可以解决不可重复读问题。不可重复读对应的是修改，即UPDATE操作，但是可能还会有幻读问题。因为幻读问题对应的是插入INSERT操作，而不是UPDATE操作。
- serializable：序列化，事务串行化顺序执行，性能最低。

## 3、数据库锁分类和总结
[锁分类和总结](https://blog.csdn.net/weixin_39651041/article/details/79985715)

## 4、事务的特性
  任何支持事务的数据库，都必须具备四个特性，分别是：原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）、持久性（Durability），也就是我们常说的事务ACID，这样才能保证事务（（Transaction）中数据的正确性。 

- 原子性（Atomicity）：原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。
- 一致性（Consistency）事务前后数据的完整性必须保持一致。
- 隔离性（Isolation）：事务的隔离性是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要相互隔离。
- 持久性（Durability)：持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的。

## 5、SQL语言分类
- DML：Data Manipulation Language，数据操纵语言，即select、insert、update、delete语句。有些地方也将select单独归为DQL。
- DDL：Data Definition Language，数据定义语言，即创建、修改、删除 表、视图、索引等。 唯一需要注意的是TRUNCATE，尽管从功能上看相当于DELETE表中所有数据，但由于它所操作的对象是table这个级别而非row（由于某种原因不能立即删除表数据时，TRUNCATE会锁定整张表，而DELETE锁定的则是row)，所以归在DDL中。并且TRUNCATE TABLE，删除这些数据的时候，系统不做日志，因此无法恢复，删除的速度比较快；而DELETE 语句也是删除表中的记录，但它要写日志，删除的数据可以恢复，数据量大的时候删除比较慢。
- DCL：Data Control Language，数据控制语言。是用来设置或更改数据库用户或角色权限的语句，包括grant,deny,revoke等语句。
- TCL：Transaction Control Language，事务控制语言，用来对事务进行管理。即COMMIT、SAVEPOINT、ROLLBACK、SET TRANSACTION等操作。
